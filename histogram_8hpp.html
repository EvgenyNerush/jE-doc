<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>jE /dʒeɪ iː/: /home/eugn/Code/jE/src/histogram.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">jE /dʒeɪ iː/
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">histogram.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Helps to plot particle distributions correctly.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;vector&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
</div>
<p><a href="histogram_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab51309acde386849edfb1ad85798a397"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="histogram_8hpp.html#ab51309acde386849edfb1ad85798a397">histogram_1D</a> (size_t n, const std::vector&lt; double &gt; &amp;xs)</td></tr>
<tr class="separator:ab51309acde386849edfb1ad85798a397"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Helps to plot particle distributions correctly. </p>
<p>Particle distribution can have singularity (e.g., <img class="formulaInl" alt="$ 1 / \sqrt{x} $" src="form_0.png" width="30" height="14"/>, <img class="formulaInl" alt="$ x &gt; 0 $" src="form_1.png" width="31" height="10"/>), and drawing the distribution by counting particles in the bins of the same size is not good in this case. This file proposes <code>histogram_1D</code> function which finds the boundaries of bins (of different sizes) which are the most appropriate for the drawing of the particle distribution: near the singularity the bins are thinner than in the regions of small values of the distribution function, and the relative error of the counted distribution function is the same for all the bins. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab51309acde386849edfb1ad85798a397"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51309acde386849edfb1ad85798a397">&#9670;&nbsp;</a></span>histogram_1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; histogram_1D </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function places the bin boundaries such that the number of particles is <code>n</code> in every bin, (thus <code> N % n </code> particles are dropped from the consideration, where <code> N = xs.size() </code> the overall number of particles). The positions of the leftmost and the rightmost boundaries are slightly shifted from minimum and maximum of the considered <code>x</code> values such that for all the bins the distribution function <img class="formulaInl" alt="$ f $" src="form_2.png" width="8" height="13"/> can be computed from the position of the left and the rignt bin boundaries <img class="formulaInl" alt="$ b_l $" src="form_3.png" width="8" height="13"/> and <img class="formulaInl" alt="$ b_r $" src="form_4.png" width="10" height="13"/> as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ f = \frac{n}{b_r - b_l}. \]" src="form_5.png" width="66" height="26"/>
</p>
<p> The complexity of this function is <img class="formulaInl" alt="$ O(N \log N) $" src="form_6.png" width="61" height="14"/> (operations). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>desired number of particles per bin </td></tr>
    <tr><td class="paramname">xs</td><td>coordinates of particles </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>positions of the bin boundaries </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.19
</small></address>
</body>
</html>
