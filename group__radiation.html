<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>jE /dʒeɪ iː/: Radiation module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">jE /dʒeɪ iː/
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Radiation module</div>  </div>
</div><!--header-->
<div class="contents">

<p>General formulas for the photon emission by an ultrarelativistic electron.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5f64170d02613e7e6c9f7283319de81b"><td class="memItemLeft" align="right" valign="top">std::optional&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__radiation.html#ga5f64170d02613e7e6c9f7283319de81b">bisection</a> (std::function&lt; double(const double &amp;)&gt; f, double xa, double xb, int n)</td></tr>
<tr class="separator:ga5f64170d02613e7e6c9f7283319de81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac054e465572cb7efa8c98709fe5dc651"><td class="memTemplParams" colspan="2">template&lt;typename R , typename V &gt; </td></tr>
<tr class="memitem:gac054e465572cb7efa8c98709fe5dc651"><td class="memTemplItemLeft" align="right" valign="top">R&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__radiation.html#gac054e465572cb7efa8c98709fe5dc651">trap_rule</a> (std::function&lt; R(double)&gt; f, V t_nodes)</td></tr>
<tr class="separator:gac054e465572cb7efa8c98709fe5dc651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga488d843f65bf952e9f185abda7fd435e"><td class="memTemplParams" colspan="2">template&lt;typename V &gt; </td></tr>
<tr class="memitem:ga488d843f65bf952e9f185abda7fd435e"><td class="memTemplItemLeft" align="right" valign="top">std::complex&lt; double &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__radiation.html#ga488d843f65bf952e9f185abda7fd435e">c_m</a> (std::function&lt; double(double)&gt; vp, std::function&lt; double(double)&gt; nr, V t_nodes, double omega)</td></tr>
<tr class="separator:ga488d843f65bf952e9f185abda7fd435e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gadeedc97114c5a704906c8e26bdbd2451"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__radiation.html#gadeedc97114c5a704906c8e26bdbd2451">alpha</a> = 1 / 137.035999084</td></tr>
<tr class="separator:gadeedc97114c5a704906c8e26bdbd2451"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>General formulas for the photon emission by an ultrarelativistic electron. </p>
<p>Formulas describing the emission of photons by an ultrarelativistic electron in the general case. I.e., the emission can occur either in the synchrotron or in the dipole regime. However, we use here normalization natural for the synchrotron emission. Thus, some value of the magnetic field <img class="formulaInl" alt="$ B $" src="form_7.png" width="10" height="10"/> is used as follows. In functions provided by this module time is normalized to the radiation formation time </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ t_{rf} = m c / (e B), \]" src="form_8.png" width="84" height="14"/>
</p>
<p> coordinates are normalized to <img class="formulaInl" alt="$ c t_{rf} $" src="form_9.png" width="20" height="13"/> and energy to the electron rest energy <img class="formulaInl" alt="$ m c^2 $" src="form_10.png" width="23" height="11"/>, i.e. <img class="formulaInl" alt="$ m $" src="form_33.png" width="13" height="6"/> the electron mass. Velocity is normalized to the speed of light <img class="formulaInl" alt="$ c $" src="form_11.png" width="5" height="6"/> and frequency is normalized to <img class="formulaInl" alt="$ 1 / t_{rf} $" src="form_12.png" width="28" height="14"/>. Note that the photon of the cyclic frequency <img class="formulaInl" alt="$ \omega $" src="form_13.png" width="9" height="6"/> in the normalized units has energy <img class="formulaInl" alt="$ \omega \, b $" src="form_14.png" width="18" height="10"/> with <img class="formulaInl" alt="$ b = B / B_S $" src="form_15.png" width="54" height="14"/>, and <img class="formulaInl" alt="$ B_S = m^2 c^3 / e \hbar $" src="form_16.png" width="80" height="15"/> the Sauter&ndash;Schwinger field (the critical field of QED). For the synchrotrom radiation formulas, see <a class="el" href="group__synchrotron__radiation.html">Synchrotron radiation module</a>. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga5f64170d02613e7e6c9f7283319de81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f64170d02613e7e6c9f7283319de81b">&#9670;&nbsp;</a></span>bisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt;double&gt; bisection </td>
          <td>(</td>
          <td class="paramtype">std::function&lt; double(const double &amp;)&gt;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a href="https://en.wikipedia.org/wiki/Bisection_method">Bisection method</a> to find the root of the equation <img class="formulaInl" alt="$ f(x) = 0 $" src="form_17.png" width="48" height="14"/> on the interval <img class="formulaInl" alt="$ [x_a, x_b] $" src="form_18.png" width="36" height="14"/>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td><img class="formulaInl" alt="$ f $" src="form_2.png" width="8" height="13"/>, a continuous function </td></tr>
    <tr><td class="paramname">xa</td><td><img class="formulaInl" alt="$ x_a $" src="form_19.png" width="14" height="9"/> </td></tr>
    <tr><td class="paramname">xb</td><td><img class="formulaInl" alt="$ x_b $" src="form_20.png" width="13" height="9"/> </td></tr>
    <tr><td class="paramname">n</td><td>the number of the iterations; the method error is less than <img class="formulaInl" alt="$ (x_b - x_a) / 2^n $" src="form_21.png" width="69" height="14"/> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code> std::nullopt </code> if the root is out of <img class="formulaInl" alt="$ [x_a, x_b] $" src="form_18.png" width="36" height="14"/>, (<code> std::optional </code> of) <img class="formulaInl" alt="$ x_a $" src="form_19.png" width="14" height="9"/> if <img class="formulaInl" alt="$ f(x_a) = 0 $" src="form_22.png" width="53" height="14"/>, <img class="formulaInl" alt="$ x_b $" src="form_20.png" width="13" height="9"/> if <img class="formulaInl" alt="$ f(x_b) = 0 $" src="form_23.png" width="51" height="14"/>, <img class="formulaInl" alt="$ (x_a + x_b) / 2 $" src="form_24.png" width="63" height="14"/> if <code>n</code> &lt; 1, and approximate root value otherwise </dd></dl>

</div>
</div>
<a id="gac054e465572cb7efa8c98709fe5dc651"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac054e465572cb7efa8c98709fe5dc651">&#9670;&nbsp;</a></span>trap_rule()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename R , typename V &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">R trap_rule </td>
          <td>(</td>
          <td class="paramtype">std::function&lt; R(double)&gt;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">V&#160;</td>
          <td class="paramname"><em>t_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Trapezoidal rule of integration. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>function to be integrated </td></tr>
    <tr><td class="paramname">t_nodes</td><td>nodes in which the values of <code>f</code> are computed; this function can take <code>t_nodes</code> as <code>range</code> or <code>view</code> (from C++20 ranges) or as <code>std::vector</code>, with doubles within </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga488d843f65bf952e9f185abda7fd435e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga488d843f65bf952e9f185abda7fd435e">&#9670;&nbsp;</a></span>c_m()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename V &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::complex&lt;double&gt; c_m </td>
          <td>(</td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>vp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">V&#160;</td>
          <td class="paramname"><em>t_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>omega</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The mode amplitude <img class="formulaInl" alt="$ C_m $" src="form_25.png" width="18" height="13"/> in the emitted field (for a unit volume <img class="formulaInl" alt="$ V = 1 $" src="form_26.png" width="33" height="10"/>), computed numerically, as follows.</p>
<p>The emitted field can be decomposed by modes of virtual superconductive rectangular box of size <img class="formulaInl" alt="$ L_x \times L_y \times L_z $" src="form_27.png" width="73" height="14"/>: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{E} = \sum_m C_m \mathbf{E}_m, \quad \mathbf{B} = \sum_m C_m \mathbf{B}_m, \]" src="form_28.png" width="189" height="28"/>
</p>
<p> with well-known sine/cosine spatial and <img class="formulaInl" alt="$ e^{-i \omega_m t} $" src="form_29.png" width="35" height="11"/> temporal structure of complex rectangular resonator modes. The modes are orthogonal </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{8 \pi} \int_V \left( \mathbf{E}_m \mathbf{E}_l^* + \mathbf{B}_m \mathbf{B}_l^* \right) \, dV = \hbar \omega_m \delta_{ml}, \]" src="form_30.png" width="213" height="30"/>
</p>
<p> thus, the energy of the emitted field is </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ I = \frac{1}{8 \pi} \int_V \left( \mathbf{EE}^* + \mathbf{BB}^* \right) \, dV = \sum_m \hbar \omega_m |C_m|^2, \]" src="form_31.png" width="251" height="33"/>
</p>
<p> and <img class="formulaInl" alt="$ |C_m|^2 $" src="form_32.png" width="30" height="15"/> can be interpreted as the emission probability of the photon of mode <img class="formulaInl" alt="$ m $" src="form_33.png" width="13" height="6"/>. It can be found from Maxwell's equations []: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ C_m = -\frac{1}{2 \hbar \omega_m} \int_t \int_V \mathbf{j E}_m^* \, dV \, dt, \]" src="form_34.png" width="169" height="30"/>
</p>
<p> where <img class="formulaInl" alt="$ \mathbf{j} = -e \mathbf{v} \delta(\mathbf{r} - \mathbf{r}(t)) $" src="form_35.png" width="101" height="14"/> is the current of the emitting electron which position is <img class="formulaInl" alt="$ \mathbf{r}(t) $" src="form_36.png" width="20" height="14"/>.</p>
<p>For an ultrarelativistic particle, which emits mostly in the forward direction, the computation of <img class="formulaInl" alt="$ C_m $" src="form_25.png" width="18" height="13"/> can be further simplified. Each of the complex modes is formed by eight complex plane waves <img class="formulaInl" alt="$ \sim \exp(-i \omega_m t + i \mathbf{k}_m \mathbf{r}) $" src="form_37.png" width="119" height="14"/> (exept a few modes with wave vector parallel to the box boundaries). This yields eight terms in the integral over <img class="formulaInl" alt="$ t $" src="form_38.png" width="5" height="9"/> in the expression for <img class="formulaInl" alt="$ C_m $" src="form_25.png" width="18" height="13"/>. One can note that one of the terms oscillates much slower than the others which hence can be dropped (e.g., <img class="formulaInl" alt="$ \exp( i \omega t - i k_x x(t)) $" src="form_39.png" width="100" height="14"/> cannot be dropped, whereas <img class="formulaInl" alt="$ \exp( i \omega t + i k_x x(t)) $" src="form_40.png" width="100" height="14"/> can be, if <img class="formulaInl" alt="$ k_x \approx \omega_m / c $" src="form_41.png" width="59" height="14"/> and <img class="formulaInl" alt="$ x(t) \approx c t $" src="form_42.png" width="49" height="14"/>). The remaining term corresponds to the wave polarization direction <img class="formulaInl" alt="$ \mathbf{p_m} $" src="form_43.png" width="19" height="9"/> (with <img class="formulaInl" alt="$ p_m^2 = 1 $" src="form_44.png" width="39" height="15"/>). The amplitude of the remaining wave, <img class="formulaInl" alt="$ a_m $" src="form_45.png" width="15" height="9"/>, can be found from the normalization: the wave energy is <img class="formulaInl" alt="$ \hbar \omega_m / 8 $" src="form_46.png" width="36" height="14"/> hence <img class="formulaInl" alt="$ a_m = (2 \pi \hbar \omega_m / V)^{1/2} $" src="form_47.png" width="111" height="16"/>. Therefore, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ C_m = - \frac{e}{2} \sqrt{ \frac{\pi}{\hbar \omega_m V} } \int_t \mathbf{v p}_m \exp \left[ i \omega_m t - i \mathbf{k}_m \mathbf{r}(t) \right] \, dt. \]" src="form_48.png" width="275" height="30"/>
</p>
<p> This formula is used here to compute <img class="formulaInl" alt="$ C_m $" src="form_25.png" width="18" height="13"/> with <a class="el" href="group__radiation.html#gac054e465572cb7efa8c98709fe5dc651">trap_rule</a>. To compute the emission probability, use <code> <a href="https://en.cppreference.com/w/cpp/numeric/complex/norm">norm </a>(c_m) </code>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vp</td><td>the product of the mode polarization direction <img class="formulaInl" alt="$ \mathbf{p} $" src="form_49.png" width="9" height="9"/> and the electron velocity <img class="formulaInl" alt="$ \mathbf{v} $" src="form_50.png" width="9" height="6"/>, as the function of <img class="formulaInl" alt="$ t $" src="form_38.png" width="5" height="9"/>. </td></tr>
    <tr><td class="paramname">nr</td><td><img class="formulaInl" alt="$ \mathbf{ n \cdot r }(t) $" src="form_51.png" width="36" height="14"/>, with <img class="formulaInl" alt="$ \mathbf{n} = c \mathbf{k}_m / \omega_m $" src="form_52.png" width="70" height="14"/> and <img class="formulaInl" alt="$ \mathbf{r}(t) $" src="form_36.png" width="20" height="14"/> the electron position </td></tr>
    <tr><td class="paramname">t_nodes</td><td>values of <img class="formulaInl" alt="$ t_0, t_1, t_2, ... $" src="form_53.png" width="58" height="11"/> used for the integral computation; this function can take <code>t_nodes</code> as <code>range</code> or <code>view</code> (from C++20 ranges) or as <code>std::vector</code>, with doubles within </td></tr>
    <tr><td class="paramname">omega</td><td>&gt; 0, normalized frequency of the emitted photon, <img class="formulaInl" alt="$ \omega_m $" src="form_54.png" width="18" height="9"/> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="gadeedc97114c5a704906c8e26bdbd2451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadeedc97114c5a704906c8e26bdbd2451">&#9670;&nbsp;</a></span>alpha</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double alpha = 1 / 137.035999084</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The fine structure constant, CODATA 2018 recommended value </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.19
</small></address>
</body>
</html>
